diff --git a/output/frameworks_native/f3d9a43a-eaf88010-f7bda296/services@inputflinger@reader@InputReader.no_comments_mergebot.cpp b/output/frameworks_native/f3d9a43a-eaf88010-f7bda296/services@inputflinger@reader@InputReader.no_comments_truth.cpp
index 1926d4b..509049a 100644
--- a/output/frameworks_native/f3d9a43a-eaf88010-f7bda296/services@inputflinger@reader@InputReader.no_comments_mergebot.cpp
+++ b/output/frameworks_native/f3d9a43a-eaf88010-f7bda296/services@inputflinger@reader@InputReader.no_comments_truth.cpp
@@ -19 +19,12 @@ namespace android {
-InputReader::InputReader(std::shared_ptr<EventHubInterface> eventHub, const sp<InputReaderPolicyInterface>& policy, const sp<InputListenerInterface>& listener): mContext(this), mEventHub(eventHub), mPolicy(policy), mNextId(1), mNextSequenceNum(1), mGlobalMetaState(0), mGeneration(1), mNextInputDeviceId(END_RESERVED_ID), mDisableVirtualKeysTimeout(LLONG_MIN), mNextTimeout(LLONG_MAX), mConfigurationChangesToRefresh(0) {
+InputReader::InputReader(std::shared_ptr<EventHubInterface> eventHub,
+                         const sp<InputReaderPolicyInterface>& policy,
+                         const sp<InputListenerInterface>& listener)
+      : mContext(this),
+        mEventHub(eventHub),
+        mPolicy(policy),
+        mGlobalMetaState(0),
+        mGeneration(1),
+        mNextInputDeviceId(END_RESERVED_ID),
+        mDisableVirtualKeysTimeout(LLONG_MIN),
+        mNextTimeout(LLONG_MAX),
+        mConfigurationChangesToRefresh(0) {
@@ -278,3233 +289,4 @@ void InputReader::getExternalStylusDevicesLocked(std::vector<InputDeviceInfo>& o
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-}
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-}
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-}
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-}
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-}
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-}
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-}
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-}
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-}
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-}
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-}
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-}
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-}
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
+void InputReader::dispatchExternalStylusState(const StylusState& state) {
+    for (auto& devicePair : mDevices) {
+        std::shared_ptr<InputDevice>& device = devicePair.second;
+        device->updateExternalStylusState(state);
@@ -3512,230 +293,0 @@ int32_t InputReader::ContextImpl::getNextId() {
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
@@ -3743,230 +295,2 @@ int32_t InputReader::ContextImpl::getNextId() {
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
+void InputReader::disableVirtualKeysUntilLocked(nsecs_t time) {
+    mDisableVirtualKeysTimeout = time;
@@ -3974,230 +298,8 @@ int32_t InputReader::ContextImpl::getNextId() {
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
+bool InputReader::shouldDropVirtualKeyLocked(nsecs_t now, int32_t keyCode, int32_t scanCode) {
+    if (now < mDisableVirtualKeysTimeout) {
+        ALOGI("Dropping virtual key from device because virtual keys are "
+              "temporarily disabled for the next %0.3fms.  keyCode=%d, scanCode=%d",
+              (mDisableVirtualKeysTimeout - now) * 0.000001, keyCode, scanCode);
+        return true;
+    } else {
+        return false;
@@ -4205,230 +306,0 @@ int32_t InputReader::ContextImpl::getNextId() {
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
@@ -4436,230 +308,6 @@ int32_t InputReader::ContextImpl::getNextId() {
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
+sp<PointerControllerInterface> InputReader::getPointerControllerLocked(int32_t deviceId) {
+    sp<PointerControllerInterface> controller = mPointerController.promote();
+    if (controller == nullptr) {
+        controller = mPolicy->obtainPointerController(deviceId);
+        mPointerController = controller;
+        updatePointerDisplayLocked();
@@ -4667,230 +315,19 @@ int32_t InputReader::ContextImpl::getNextId() {
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
+    return controller;
+}
+void InputReader::updatePointerDisplayLocked() {
+    sp<PointerControllerInterface> controller = mPointerController.promote();
+    if (controller == nullptr) {
+        return;
+    }
+    std::optional<DisplayViewport> viewport =
+            mConfig.getDisplayViewportById(mConfig.defaultPointerDisplayId);
+    if (!viewport) {
+        ALOGW("Can't find the designated viewport with ID %" PRId32 " to update cursor input "
+              "mapper. Fall back to default display",
+              mConfig.defaultPointerDisplayId);
+        viewport = mConfig.getDisplayViewportById(ADISPLAY_ID_DEFAULT);
+    }
+    if (!viewport) {
+        ALOGE("Still can't find a viable viewport to update cursor input mapper. Skip setting it to"
+              " PointerController.");
+        return;
@@ -4898,230 +335 @@ int32_t InputReader::ContextImpl::getNextId() {
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
+    controller->setDisplayViewport(*viewport);
@@ -5129,230 +337,4 @@ int32_t InputReader::ContextImpl::getNextId() {
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
+void InputReader::fadePointerLocked() {
+    sp<PointerControllerInterface> controller = mPointerController.promote();
+    if (controller != nullptr) {
+        controller->fade(PointerControllerInterface::TRANSITION_GRADUAL);
@@ -5360,230 +341,0 @@ int32_t InputReader::ContextImpl::getNextId() {
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
@@ -5591,230 +343,4 @@ int32_t InputReader::ContextImpl::getNextId() {
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
+void InputReader::requestTimeoutAtTimeLocked(nsecs_t when) {
+    if (when < mNextTimeout) {
+        mNextTimeout = when;
+        mEventHub->wake();
@@ -5822,232 +347,0 @@ int32_t InputReader::ContextImpl::getNextId() {
-InputReader::ContextImpl::ContextImpl(InputReader* reader)
-      : mReader(reader), mIdGenerator(IdGenerator::Source::INPUT_READER) {}
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
@@ -6055,230 +349,47 @@ int32_t InputReader::ContextImpl::getNextId() {
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
+int32_t InputReader::bumpGenerationLocked() {
+    return ++mGeneration;
+}
+void InputReader::getInputDevices(std::vector<InputDeviceInfo>& outInputDevices) {
+    AutoMutex _l(mLock);
+    getInputDevicesLocked(outInputDevices);
+}
+void InputReader::getInputDevicesLocked(std::vector<InputDeviceInfo>& outInputDevices) {
+    outInputDevices.clear();
+    for (auto& devicePair : mDevices) {
+        std::shared_ptr<InputDevice>& device = devicePair.second;
+        if (!device->isIgnored()) {
+            InputDeviceInfo info;
+            device->getDeviceInfo(&info);
+            outInputDevices.push_back(info);
+        }
+    }
+}
+int32_t InputReader::getKeyCodeState(int32_t deviceId, uint32_t sourceMask, int32_t keyCode) {
+    AutoMutex _l(mLock);
+    return getStateLocked(deviceId, sourceMask, keyCode, &InputDevice::getKeyCodeState);
+}
+int32_t InputReader::getScanCodeState(int32_t deviceId, uint32_t sourceMask, int32_t scanCode) {
+    AutoMutex _l(mLock);
+    return getStateLocked(deviceId, sourceMask, scanCode, &InputDevice::getScanCodeState);
+}
+int32_t InputReader::getSwitchState(int32_t deviceId, uint32_t sourceMask, int32_t switchCode) {
+    AutoMutex _l(mLock);
+    return getStateLocked(deviceId, sourceMask, switchCode, &InputDevice::getSwitchState);
+}
+int32_t InputReader::getStateLocked(int32_t deviceId, uint32_t sourceMask, int32_t code,
+                                    GetStateFunc getStateFunc) {
+    int32_t result = AKEY_STATE_UNKNOWN;
+    if (deviceId >= 0) {
+        InputDevice* device = findInputDevice(deviceId);
+        if (device && !device->isIgnored() && sourcesMatchMask(device->getSources(), sourceMask)) {
+            result = (device->*getStateFunc)(sourceMask, code);
+        }
+    } else {
+        for (auto& devicePair : mDevices) {
+            std::shared_ptr<InputDevice>& device = devicePair.second;
+            if (!device->isIgnored() && sourcesMatchMask(device->getSources(), sourceMask)) {
+                int32_t currentResult = (device.get()->*getStateFunc)(sourceMask, code);
+                if (currentResult >= AKEY_STATE_DOWN) {
+                    return currentResult;
+                } else if (currentResult == AKEY_STATE_UP) {
+                    result = currentResult;
@@ -6286,230 +396,0 @@ int32_t InputReader::ContextImpl::getNextId() {
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
@@ -6517,230 +397,0 @@ int32_t InputReader::ContextImpl::getNextId() {
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
@@ -6748,230 +398,0 @@ int32_t InputReader::ContextImpl::getNextId() {
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
@@ -6979,230 +400 @@ int32_t InputReader::ContextImpl::getNextId() {
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
+    return result;
@@ -7210,230 +402,52 @@ int32_t InputReader::ContextImpl::getNextId() {
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
+void InputReader::toggleCapsLockState(int32_t deviceId) {
+    InputDevice* device = findInputDevice(deviceId);
+    if (!device) {
+        ALOGW("Ignoring toggleCapsLock for unknown deviceId %" PRId32 ".", deviceId);
+        return;
+    }
+    if (device->isIgnored()) {
+        return;
+    }
+    device->updateMetaState(AKEYCODE_CAPS_LOCK);
+}
+bool InputReader::hasKeys(int32_t deviceId, uint32_t sourceMask, size_t numCodes,
+                          const int32_t* keyCodes, uint8_t* outFlags) {
+    AutoMutex _l(mLock);
+    memset(outFlags, 0, numCodes);
+    return markSupportedKeyCodesLocked(deviceId, sourceMask, numCodes, keyCodes, outFlags);
+}
+bool InputReader::markSupportedKeyCodesLocked(int32_t deviceId, uint32_t sourceMask,
+                                              size_t numCodes, const int32_t* keyCodes,
+                                              uint8_t* outFlags) {
+    bool result = false;
+    if (deviceId >= 0) {
+        InputDevice* device = findInputDevice(deviceId);
+        if (device && !device->isIgnored() && sourcesMatchMask(device->getSources(), sourceMask)) {
+            result = device->markSupportedKeyCodes(sourceMask, numCodes, keyCodes, outFlags);
+        }
+    } else {
+        for (auto& devicePair : mDevices) {
+            std::shared_ptr<InputDevice>& device = devicePair.second;
+            if (!device->isIgnored() && sourcesMatchMask(device->getSources(), sourceMask)) {
+                result |= device->markSupportedKeyCodes(sourceMask, numCodes, keyCodes, outFlags);
+            }
+        }
+    }
+    return result;
+}
+void InputReader::requestRefreshConfiguration(uint32_t changes) {
+    AutoMutex _l(mLock);
+    if (changes) {
+        bool needWake = !mConfigurationChangesToRefresh;
+        mConfigurationChangesToRefresh |= changes;
+        if (needWake) {
+            mEventHub->wake();
+        }
+    }
+}
+void InputReader::vibrate(int32_t deviceId, const nsecs_t* pattern, size_t patternSize,
+                          ssize_t repeat, int32_t token) {
+    AutoMutex _l(mLock);
+    InputDevice* device = findInputDevice(deviceId);
+    if (device) {
+        device->vibrate(pattern, patternSize, repeat, token);
@@ -7441,230 +454,0 @@ int32_t InputReader::ContextImpl::getNextId() {
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
@@ -7672,230 +456,5 @@ int32_t InputReader::ContextImpl::getNextId() {
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
+void InputReader::cancelVibrate(int32_t deviceId, int32_t token) {
+    AutoMutex _l(mLock);
+    InputDevice* device = findInputDevice(deviceId);
+    if (device) {
+        device->cancelVibrate(token);
@@ -7903,230 +461,0 @@ int32_t InputReader::ContextImpl::getNextId() {
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
@@ -8134,230 +463,5 @@ int32_t InputReader::ContextImpl::getNextId() {
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
+bool InputReader::isInputDeviceEnabled(int32_t deviceId) {
+    AutoMutex _l(mLock);
+    InputDevice* device = findInputDevice(deviceId);
+    if (device) {
+        return device->isEnabled();
@@ -8365,230 +469,2 @@ int32_t InputReader::ContextImpl::getNextId() {
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
+    ALOGW("Ignoring invalid device id %" PRId32 ".", deviceId);
+    return false;
@@ -8596,230 +472,128 @@ int32_t InputReader::ContextImpl::getNextId() {
-int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
+bool InputReader::canDispatchToDisplay(int32_t deviceId, int32_t displayId) {
+    AutoMutex _l(mLock);
+    InputDevice* device = findInputDevice(deviceId);
+    if (!device) {
+        ALOGW("Ignoring invalid device id %" PRId32 ".", deviceId);
+        return false;
+    }
+    if (!device->isEnabled()) {
+        ALOGW("Ignoring disabled device %s", device->getName().c_str());
+        return false;
+    }
+    std::optional<int32_t> associatedDisplayId = device->getAssociatedDisplayId();
+    if (!associatedDisplayId) {
+        return true;
+    }
+    if (*associatedDisplayId == ADISPLAY_ID_NONE) {
+        ALOGW("Device %s is associated with display ADISPLAY_ID_NONE.", device->getName().c_str());
+        return true;
+    }
+    return *associatedDisplayId == displayId;
+}
+void InputReader::dump(std::string& dump) {
+    AutoMutex _l(mLock);
+    mEventHub->dump(dump);
+    dump += "\n";
+    dump += "Input Reader State:\n";
+    for (const auto& devicePair : mDevices) {
+        const std::shared_ptr<InputDevice>& device = devicePair.second;
+        device->dump(dump);
+    }
+    dump += INDENT "Configuration:\n";
+    dump += INDENT2 "ExcludedDeviceNames: [";
+    for (size_t i = 0; i < mConfig.excludedDeviceNames.size(); i++) {
+        if (i != 0) {
+            dump += ", ";
+        }
+        dump += mConfig.excludedDeviceNames[i];
+    }
+    dump += "]\n";
+    dump += StringPrintf(INDENT2 "VirtualKeyQuietTime: %0.1fms\n",
+                         mConfig.virtualKeyQuietTime * 0.000001f);
+    dump += StringPrintf(INDENT2 "PointerVelocityControlParameters: "
+                                 "scale=%0.3f, lowThreshold=%0.3f, highThreshold=%0.3f, "
+                                 "acceleration=%0.3f\n",
+                         mConfig.pointerVelocityControlParameters.scale,
+                         mConfig.pointerVelocityControlParameters.lowThreshold,
+                         mConfig.pointerVelocityControlParameters.highThreshold,
+                         mConfig.pointerVelocityControlParameters.acceleration);
+    dump += StringPrintf(INDENT2 "WheelVelocityControlParameters: "
+                                 "scale=%0.3f, lowThreshold=%0.3f, highThreshold=%0.3f, "
+                                 "acceleration=%0.3f\n",
+                         mConfig.wheelVelocityControlParameters.scale,
+                         mConfig.wheelVelocityControlParameters.lowThreshold,
+                         mConfig.wheelVelocityControlParameters.highThreshold,
+                         mConfig.wheelVelocityControlParameters.acceleration);
+    dump += StringPrintf(INDENT2 "PointerGesture:\n");
+    dump += StringPrintf(INDENT3 "Enabled: %s\n", toString(mConfig.pointerGesturesEnabled));
+    dump += StringPrintf(INDENT3 "QuietInterval: %0.1fms\n",
+                         mConfig.pointerGestureQuietInterval * 0.000001f);
+    dump += StringPrintf(INDENT3 "DragMinSwitchSpeed: %0.1fpx/s\n",
+                         mConfig.pointerGestureDragMinSwitchSpeed);
+    dump += StringPrintf(INDENT3 "TapInterval: %0.1fms\n",
+                         mConfig.pointerGestureTapInterval * 0.000001f);
+    dump += StringPrintf(INDENT3 "TapDragInterval: %0.1fms\n",
+                         mConfig.pointerGestureTapDragInterval * 0.000001f);
+    dump += StringPrintf(INDENT3 "TapSlop: %0.1fpx\n", mConfig.pointerGestureTapSlop);
+    dump += StringPrintf(INDENT3 "MultitouchSettleInterval: %0.1fms\n",
+                         mConfig.pointerGestureMultitouchSettleInterval * 0.000001f);
+    dump += StringPrintf(INDENT3 "MultitouchMinDistance: %0.1fpx\n",
+                         mConfig.pointerGestureMultitouchMinDistance);
+    dump += StringPrintf(INDENT3 "SwipeTransitionAngleCosine: %0.1f\n",
+                         mConfig.pointerGestureSwipeTransitionAngleCosine);
+    dump += StringPrintf(INDENT3 "SwipeMaxWidthRatio: %0.1f\n",
+                         mConfig.pointerGestureSwipeMaxWidthRatio);
+    dump += StringPrintf(INDENT3 "MovementSpeedRatio: %0.1f\n",
+                         mConfig.pointerGestureMovementSpeedRatio);
+    dump += StringPrintf(INDENT3 "ZoomSpeedRatio: %0.1f\n", mConfig.pointerGestureZoomSpeedRatio);
+    dump += INDENT3 "Viewports:\n";
+    mConfig.dump(dump);
+}
+void InputReader::monitor() {
+    mLock.lock();
+    mEventHub->wake();
+    mReaderIsAliveCondition.wait(mLock);
+    mLock.unlock();
+    mEventHub->monitor();
+}
+InputReader::ContextImpl::ContextImpl(InputReader* reader)
+      : mReader(reader), mIdGenerator(IdGenerator::Source::INPUT_READER) {}
+void InputReader::ContextImpl::updateGlobalMetaState() {
+    mReader->updateGlobalMetaStateLocked();
+}
+int32_t InputReader::ContextImpl::getGlobalMetaState() {
+    return mReader->getGlobalMetaStateLocked();
+}
+void InputReader::ContextImpl::disableVirtualKeysUntil(nsecs_t time) {
+    mReader->disableVirtualKeysUntilLocked(time);
+}
+bool InputReader::ContextImpl::shouldDropVirtualKey(nsecs_t now, int32_t keyCode,
+                                                    int32_t scanCode) {
+    return mReader->shouldDropVirtualKeyLocked(now, keyCode, scanCode);
+}
+void InputReader::ContextImpl::fadePointer() {
+    mReader->fadePointerLocked();
+}
+sp<PointerControllerInterface> InputReader::ContextImpl::getPointerController(int32_t deviceId) {
+    return mReader->getPointerControllerLocked(deviceId);
+}
+void InputReader::ContextImpl::requestTimeoutAtTime(nsecs_t when) {
+    mReader->requestTimeoutAtTimeLocked(when);
+}
+int32_t InputReader::ContextImpl::bumpGeneration() {
+    return mReader->bumpGenerationLocked();
+}
+void InputReader::ContextImpl::getExternalStylusDevices(std::vector<InputDeviceInfo>& outDevices) {
+    mReader->getExternalStylusDevicesLocked(outDevices);
+}
+void InputReader::ContextImpl::dispatchExternalStylusState(const StylusState& state) {
+    mReader->dispatchExternalStylusState(state);
+}
+InputReaderPolicyInterface* InputReader::ContextImpl::getPolicy() {
+    return mReader->mPolicy.get();
+}
+InputListenerInterface* InputReader::ContextImpl::getListener() {
+    return mReader->mQueuedListener.get();
+}
+EventHubInterface* InputReader::ContextImpl::getEventHub() {
+    return mReader->mEventHub.get();
@@ -8828,112 +601,0 @@ int32_t InputReader::ContextImpl::getNextId() {
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
-    return mIdGenerator.nextId();
-||||||| f7bda296de
-<<<<<<< HEAD
@@ -8941,116 +602,0 @@ int32_t InputReader::ContextImpl::getNextId() {
-||||||| f7bda296de
-    return (mReader->mNextSequenceNum)++;
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
-=======
-    return (mReader->mNextId)++;
->>>>>>> eaf88010
