diff --git a/home/whalien/codebase/cpp/mergebot/eva/output/redis/61853ad8-a9628142-bc5cb168/src@module.no_comments_mergebot.c b/home/whalien/codebase/cpp/mergebot/eva/output/redis/61853ad8-a9628142-bc5cb168/src@module.no_comments_merged.c
index 1994a5d..3c0c165 100644
--- a/home/whalien/codebase/cpp/mergebot/eva/output/redis/61853ad8-a9628142-bc5cb168/src@module.no_comments_mergebot.c
+++ b/home/whalien/codebase/cpp/mergebot/eva/output/redis/61853ad8-a9628142-bc5cb168/src@module.no_comments_merged.c
@@ -4 +3,0 @@
-#include <sys/wait.h>
@@ -5,0 +5 @@
+#include <sys/wait.h>
@@ -16,2 +16 @@ typedef struct RedisModuleInfoCtx {
-typedef void (*RedisModuleInfoFunc)(RedisModuleInfoCtx *ctx,
-                                    int for_crash_report);
+typedef void (*RedisModuleInfoFunc)(RedisModuleInfoCtx *ctx, int for_crash_report);
@@ -28 +26,0 @@ struct RedisModule {
-  RedisModuleInfoFunc info_cb;
@@ -29,0 +28 @@ struct RedisModule {
+    RedisModuleInfoFunc info_cb;
@@ -73,5 +72 @@ typedef struct RedisModuleCtx RedisModuleCtx;
-#define REDISMODULE_CTX_INIT \
-  { \
-    (void *)(unsigned long)&RM_GetApi, NULL, NULL, NULL, NULL, 0, 0, 0, NULL, \
-        0, NULL, NULL, 0, NULL \
-  }
+#define REDISMODULE_CTX_INIT {(void*)(unsigned long)&RM_GetApi, NULL, NULL, NULL, NULL, 0, 0, 0, NULL, 0, NULL, NULL, 0, NULL}
@@ -107,2 +102 @@ typedef int (*RedisModuleCmdFunc)(RedisModuleCtx *ctx, void **argv, int argc);
-typedef void (*RedisModuleDisconnectFunc)(RedisModuleCtx *ctx,
-                                          struct RedisModuleBlockedClient *bc);
+typedef void (*RedisModuleDisconnectFunc) (RedisModuleCtx *ctx, struct RedisModuleBlockedClient *bc);
@@ -117,2 +111 @@ typedef struct RedisModuleCommandProxy RedisModuleCommandProxy;
-#define REDISMODULE_REPLYFLAG_NESTED \
-  (1 << 1)
+#define REDISMODULE_REPLYFLAG_NESTED (1<<1)
@@ -138,2 +131 @@ typedef struct RedisModuleBlockedClient {
-  void (*free_privdata)(RedisModuleCtx *,
-                        void *);
+    void (*free_privdata)(RedisModuleCtx*,void*);
@@ -147,3 +139 @@ static pthread_mutex_t moduleGIL = PTHREAD_MUTEX_INITIALIZER;
-typedef int (*RedisModuleNotificationFunc)(RedisModuleCtx *ctx, int type,
-                                           const char *event,
-                                           RedisModuleString *key);
+typedef int (*RedisModuleNotificationFunc) (RedisModuleCtx *ctx, int type, const char *event, RedisModuleString *key);
@@ -169,2 +159 @@ typedef struct RedisModuleCommandFilterCtx {
-typedef void (*RedisModuleCommandFilterFunc)(
-    RedisModuleCommandFilterCtx *filter);
+typedef void (*RedisModuleCommandFilterFunc) (RedisModuleCommandFilterCtx *filter);
@@ -177,2 +166 @@ static list *moduleCommandFilters;
-typedef void (*RedisModuleForkDoneHandler)(int exitcode, int bysignal,
-                                           void *user_data);
+typedef void (*RedisModuleForkDoneHandler) (int exitcode, int bysignal, void *user_data);
@@ -186,2 +174 @@ void autoMemoryCollect(RedisModuleCtx *ctx);
-robj **moduleCreateArgvFromUserFormat(const char *cmdname, const char *fmt,
-                                      int *argcp, int *flags, va_list ap);
+robj **moduleCreateArgvFromUserFormat(const char *cmdname, const char *fmt, int *argcp, int *flags, va_list ap);
@@ -192,5 +179,15 @@ void RM_FreeDict(RedisModuleCtx *ctx, RedisModuleDict *d);
-void *RM_Alloc(size_t bytes) { return zmalloc(bytes); }
-void *RM_Calloc(size_t nmemb, size_t size) { return zcalloc(nmemb * size); }
-void *RM_Realloc(void *ptr, size_t bytes) { return zrealloc(ptr, bytes); }
-void RM_Free(void *ptr) { zfree(ptr); }
-char *RM_Strdup(const char *str) { return zstrdup(str); }
+void *RM_Alloc(size_t bytes) {
+    return zmalloc(bytes);
+}
+void *RM_Calloc(size_t nmemb, size_t size) {
+    return zcalloc(nmemb*size);
+}
+void* RM_Realloc(void *ptr, size_t bytes) {
+    return zrealloc(ptr,bytes);
+}
+void RM_Free(void *ptr) {
+    zfree(ptr);
+}
+char *RM_Strdup(const char *str) {
+    return zstrdup(str);
+}
@@ -213 +210,2 @@ void *RM_PoolAlloc(RedisModuleCtx *ctx, size_t bytes) {
-    if (b->used % alignment) b->used += alignment - (b->used % alignment);
+        if (b->used % alignment)
+            b->used += alignment - (b->used % alignment);
@@ -231 +229,2 @@ int moduleCreateEmptyKey(RedisModuleKey *key, int type) {
-  if (!(key->mode & REDISMODULE_WRITE) || key->value) return REDISMODULE_ERR;
+    if (!(key->mode & REDISMODULE_WRITE) || key->value)
+        return REDISMODULE_ERR;
@@ -244,2 +243 @@ int moduleCreateEmptyKey(RedisModuleKey *key, int type) {
-    default:
-      return REDISMODULE_ERR;
+    default: return REDISMODULE_ERR;
@@ -256,14 +254,5 @@ int moduleDelKeyIfEmpty(RedisModuleKey *key) {
-    case OBJ_LIST:
-      isempty = listTypeLength(o) == 0;
-      break;
-    case OBJ_SET:
-      isempty = setTypeSize(o) == 0;
-      break;
-    case OBJ_ZSET:
-      isempty = zsetLength(o) == 0;
-      break;
-    case OBJ_HASH:
-      isempty = hashTypeLength(o) == 0;
-      break;
-    default:
-      isempty = 0;
+    case OBJ_LIST: isempty = listTypeLength(o) == 0; break;
+    case OBJ_SET: isempty = setTypeSize(o) == 0; break;
+    case OBJ_ZSET: isempty = zsetLength(o) == 0; break;
+    case OBJ_HASH : isempty = hashTypeLength(o) == 0; break;
+    default: isempty = 0;
@@ -291,2 +280 @@ void moduleFreeContext(RedisModuleCtx *ctx) {
-    serverLog(
-        LL_WARNING,
+        serverLog(LL_WARNING,
@@ -321 +309,2 @@ void RedisModuleCommandDispatcher(client *c) {
-    if (c->argv[i]->refcount > 1) trimStringObjectIfNeeded(c->argv[i]);
+        if (c->argv[i]->refcount > 1)
+            trimStringObjectIfNeeded(c->argv[i]);
@@ -324,2 +313 @@ void RedisModuleCommandDispatcher(client *c) {
-int *moduleGetCommandKeysViaAPI(struct redisCommand *cmd, robj **argv, int argc,
-                                int *numkeys) {
+int *moduleGetCommandKeysViaAPI(struct redisCommand *cmd, robj **argv, int argc, int *numkeys) {
@@ -352,28 +340,14 @@ int commandFlagsFromString(char *s) {
-    if (!strcasecmp(t, "write"))
-      flags |= CMD_WRITE;
-    else if (!strcasecmp(t, "readonly"))
-      flags |= CMD_READONLY;
-    else if (!strcasecmp(t, "admin"))
-      flags |= CMD_ADMIN;
-    else if (!strcasecmp(t, "deny-oom"))
-      flags |= CMD_DENYOOM;
-    else if (!strcasecmp(t, "deny-script"))
-      flags |= CMD_NOSCRIPT;
-    else if (!strcasecmp(t, "allow-loading"))
-      flags |= CMD_LOADING;
-    else if (!strcasecmp(t, "pubsub"))
-      flags |= CMD_PUBSUB;
-    else if (!strcasecmp(t, "random"))
-      flags |= CMD_RANDOM;
-    else if (!strcasecmp(t, "allow-stale"))
-      flags |= CMD_STALE;
-    else if (!strcasecmp(t, "no-monitor"))
-      flags |= CMD_SKIP_MONITOR;
-    else if (!strcasecmp(t, "fast"))
-      flags |= CMD_FAST;
-    else if (!strcasecmp(t, "getkeys-api"))
-      flags |= CMD_MODULE_GETKEYS;
-    else if (!strcasecmp(t, "no-cluster"))
-      flags |= CMD_MODULE_NO_CLUSTER;
-    else
-      break;
+        if (!strcasecmp(t,"write")) flags |= CMD_WRITE;
+        else if (!strcasecmp(t,"readonly")) flags |= CMD_READONLY;
+        else if (!strcasecmp(t,"admin")) flags |= CMD_ADMIN;
+        else if (!strcasecmp(t,"deny-oom")) flags |= CMD_DENYOOM;
+        else if (!strcasecmp(t,"deny-script")) flags |= CMD_NOSCRIPT;
+        else if (!strcasecmp(t,"allow-loading")) flags |= CMD_LOADING;
+        else if (!strcasecmp(t,"pubsub")) flags |= CMD_PUBSUB;
+        else if (!strcasecmp(t,"random")) flags |= CMD_RANDOM;
+        else if (!strcasecmp(t,"allow-stale")) flags |= CMD_STALE;
+        else if (!strcasecmp(t,"no-monitor")) flags |= CMD_SKIP_MONITOR;
+        else if (!strcasecmp(t,"fast")) flags |= CMD_FAST;
+        else if (!strcasecmp(t,"getkeys-api")) flags |= CMD_MODULE_GETKEYS;
+        else if (!strcasecmp(t,"no-cluster")) flags |= CMD_MODULE_NO_CLUSTER;
+        else break;
@@ -385,3 +359 @@ int commandFlagsFromString(char *s) {
-int RM_CreateCommand(RedisModuleCtx *ctx, const char *name,
-                     RedisModuleCmdFunc cmdfunc, const char *strflags,
-                     int firstkey, int lastkey, int keystep) {
+int RM_CreateCommand(RedisModuleCtx *ctx, const char *name, RedisModuleCmdFunc cmdfunc, const char *strflags, int firstkey, int lastkey, int keystep) {
@@ -418,2 +390 @@ int RM_CreateCommand(RedisModuleCtx *ctx, const char *name,
-void RM_SetModuleAttribs(RedisModuleCtx *ctx, const char *name, int ver,
-                         int apiver) {
+void RM_SetModuleAttribs(RedisModuleCtx *ctx, const char *name, int ver, int apiver) {
@@ -439 +410,3 @@ int RM_IsModuleNameBusy(const char *name) {
-long long RM_Milliseconds(void) { return mstime(); }
+long long RM_Milliseconds(void) {
+    return mstime();
+}
@@ -451,2 +424 @@ void autoMemoryAdd(RedisModuleCtx *ctx, int type, void *ptr) {
-    ctx->amqueue =
-        zrealloc(ctx->amqueue, sizeof(struct AutoMemEntry) * ctx->amqueue_len);
+        ctx->amqueue = zrealloc(ctx->amqueue,sizeof(struct AutoMemEntry)*ctx->amqueue_len);
@@ -464 +436,3 @@ int autoMemoryFreed(RedisModuleCtx *ctx, int type, void *ptr) {
-      if (ctx->amqueue[i].type == type && ctx->amqueue[i].ptr == ptr) {
+            if (ctx->amqueue[i].type == type &&
+                ctx->amqueue[i].ptr == ptr)
+            {
@@ -483,12 +457,4 @@ void autoMemoryCollect(RedisModuleCtx *ctx) {
-      case REDISMODULE_AM_STRING:
-        decrRefCount(ptr);
-        break;
-      case REDISMODULE_AM_REPLY:
-        RM_FreeCallReply(ptr);
-        break;
-      case REDISMODULE_AM_KEY:
-        RM_CloseKey(ptr);
-        break;
-      case REDISMODULE_AM_DICT:
-        RM_FreeDict(NULL, ptr);
-        break;
+        case REDISMODULE_AM_STRING: decrRefCount(ptr); break;
+        case REDISMODULE_AM_REPLY: RM_FreeCallReply(ptr); break;
+        case REDISMODULE_AM_KEY: RM_CloseKey(ptr); break;
+        case REDISMODULE_AM_DICT: RM_FreeDict(NULL,ptr); break;
@@ -503,2 +469 @@ void autoMemoryCollect(RedisModuleCtx *ctx) {
-RedisModuleString *RM_CreateString(RedisModuleCtx *ctx, const char *ptr,
-                                   size_t len) {
+RedisModuleString *RM_CreateString(RedisModuleCtx *ctx, const char *ptr, size_t len) {
@@ -509,2 +474 @@ RedisModuleString *RM_CreateString(RedisModuleCtx *ctx, const char *ptr,
-RedisModuleString *RM_CreateStringPrintf(RedisModuleCtx *ctx, const char *fmt,
-                                         ...) {
+RedisModuleString *RM_CreateStringPrintf(RedisModuleCtx *ctx, const char *fmt, ...) {
@@ -520,2 +484 @@ RedisModuleString *RM_CreateStringPrintf(RedisModuleCtx *ctx, const char *fmt,
-RedisModuleString *RM_CreateStringFromLongLong(RedisModuleCtx *ctx,
-                                               long long ll) {
+RedisModuleString *RM_CreateStringFromLongLong(RedisModuleCtx *ctx, long long ll) {
@@ -526,2 +489 @@ RedisModuleString *RM_CreateStringFromLongLong(RedisModuleCtx *ctx,
-RedisModuleString *RM_CreateStringFromString(RedisModuleCtx *ctx,
-                                             const RedisModuleString *str) {
+RedisModuleString *RM_CreateStringFromString(RedisModuleCtx *ctx, const RedisModuleString *str) {
@@ -551,2 +513,2 @@ int RM_StringToLongLong(const RedisModuleString *str, long long *ll) {
-  return string2ll(str->ptr, sdslen(str->ptr), ll) ? REDISMODULE_OK
-                                                   : REDISMODULE_ERR;
+    return string2ll(str->ptr,sdslen(str->ptr),ll) ? REDISMODULE_OK :
+                                                     REDISMODULE_ERR;
@@ -578,2 +540 @@ RedisModuleString *moduleAssertUnsharedString(RedisModuleString *str) {
-int RM_StringAppendBuffer(RedisModuleCtx *ctx, RedisModuleString *str,
-                          const char *buf, size_t len) {
+int RM_StringAppendBuffer(RedisModuleCtx *ctx, RedisModuleString *str, const char *buf, size_t len) {
@@ -587 +548,2 @@ int RM_WrongArity(RedisModuleCtx *ctx) {
-  addReplyErrorFormat(ctx->client, "wrong number of arguments for '%s' command",
+    addReplyErrorFormat(ctx->client,
+        "wrong number of arguments for '%s' command",
@@ -625,4 +587,4 @@ int RM_ReplyWithArray(RedisModuleCtx *ctx, long len) {
-    ctx->postponed_arrays =
-        zrealloc(ctx->postponed_arrays,
-                 sizeof(void *) * (ctx->postponed_arrays_count + 1));
-    ctx->postponed_arrays[ctx->postponed_arrays_count] = addReplyDeferredLen(c);
+        ctx->postponed_arrays = zrealloc(ctx->postponed_arrays,sizeof(void*)*
+                (ctx->postponed_arrays_count+1));
+        ctx->postponed_arrays[ctx->postponed_arrays_count] =
+            addReplyDeferredLen(c);
@@ -643,2 +605 @@ void RM_ReplySetArrayLength(RedisModuleCtx *ctx, long len) {
-              "call.",
-              ctx->module->name);
+            "call.", ctx->module->name);
@@ -648 +609,2 @@ void RM_ReplySetArrayLength(RedisModuleCtx *ctx, long len) {
-  setDeferredArrayLen(c, ctx->postponed_arrays[ctx->postponed_arrays_count],
+    setDeferredArrayLen(c,
+            ctx->postponed_arrays[ctx->postponed_arrays_count],
@@ -699,2 +661 @@ void moduleReplicateMultiIfNeeded(RedisModuleCtx *ctx) {
-int RM_Replicate(RedisModuleCtx *ctx, const char *cmdname, const char *fmt,
-                 ...) {
+int RM_Replicate(RedisModuleCtx *ctx, const char *cmdname, const char *fmt, ...) {
@@ -720,2 +681,3 @@ int RM_ReplicateVerbatim(RedisModuleCtx *ctx) {
-  alsoPropagate(ctx->client->cmd, ctx->client->db->id, ctx->client->argv,
-                ctx->client->argc, PROPAGATE_AOF | PROPAGATE_REPL);
+    alsoPropagate(ctx->client->cmd,ctx->client->db->id,
+        ctx->client->argv,ctx->client->argc,
+        PROPAGATE_AOF|PROPAGATE_REPL);
@@ -729 +691,3 @@ unsigned long long RM_GetClientId(RedisModuleCtx *ctx) {
-int RM_GetSelectedDb(RedisModuleCtx *ctx) { return ctx->client->db->id; }
+int RM_GetSelectedDb(RedisModuleCtx *ctx) {
+    return ctx->client->db->id;
+}
@@ -733,2 +697,4 @@ int RM_GetContextFlags(RedisModuleCtx *ctx) {
-    if (ctx->client->flags & CLIENT_LUA) flags |= REDISMODULE_CTX_FLAGS_LUA;
-    if (ctx->client->flags & CLIENT_MULTI) flags |= REDISMODULE_CTX_FLAGS_MULTI;
+        if (ctx->client->flags & CLIENT_LUA)
+         flags |= REDISMODULE_CTX_FLAGS_LUA;
+        if (ctx->client->flags & CLIENT_MULTI)
+         flags |= REDISMODULE_CTX_FLAGS_MULTI;
@@ -738,2 +704,4 @@ int RM_GetContextFlags(RedisModuleCtx *ctx) {
-  if (server.cluster_enabled) flags |= REDISMODULE_CTX_FLAGS_CLUSTER;
-  if (server.loading) flags |= REDISMODULE_CTX_FLAGS_LOADING;
+    if (server.cluster_enabled)
+        flags |= REDISMODULE_CTX_FLAGS_CLUSTER;
+    if (server.loading)
+        flags |= REDISMODULE_CTX_FLAGS_LOADING;
@@ -745,2 +713,4 @@ int RM_GetContextFlags(RedisModuleCtx *ctx) {
-  if (server.aof_state != AOF_OFF) flags |= REDISMODULE_CTX_FLAGS_AOF;
-  if (server.saveparamslen > 0) flags |= REDISMODULE_CTX_FLAGS_RDB;
+    if (server.aof_state != AOF_OFF)
+        flags |= REDISMODULE_CTX_FLAGS_AOF;
+    if (server.saveparamslen > 0)
+        flags |= REDISMODULE_CTX_FLAGS_RDB;
@@ -751 +721,2 @@ int RM_GetContextFlags(RedisModuleCtx *ctx) {
-    if (server.repl_slave_ro) flags |= REDISMODULE_CTX_FLAGS_READONLY;
+        if (server.repl_slave_ro)
+            flags |= REDISMODULE_CTX_FLAGS_READONLY;
@@ -797,14 +768,7 @@ int RM_KeyType(RedisModuleKey *key) {
-    case OBJ_STRING:
-      return REDISMODULE_KEYTYPE_STRING;
-    case OBJ_LIST:
-      return REDISMODULE_KEYTYPE_LIST;
-    case OBJ_SET:
-      return REDISMODULE_KEYTYPE_SET;
-    case OBJ_ZSET:
-      return REDISMODULE_KEYTYPE_ZSET;
-    case OBJ_HASH:
-      return REDISMODULE_KEYTYPE_HASH;
-    case OBJ_MODULE:
-      return REDISMODULE_KEYTYPE_MODULE;
-    default:
-      return 0;
+    case OBJ_STRING: return REDISMODULE_KEYTYPE_STRING;
+    case OBJ_LIST: return REDISMODULE_KEYTYPE_LIST;
+    case OBJ_SET: return REDISMODULE_KEYTYPE_SET;
+    case OBJ_ZSET: return REDISMODULE_KEYTYPE_ZSET;
+    case OBJ_HASH: return REDISMODULE_KEYTYPE_HASH;
+    case OBJ_MODULE: return REDISMODULE_KEYTYPE_MODULE;
+    default: return 0;
@@ -816,12 +780,6 @@ size_t RM_ValueLength(RedisModuleKey *key) {
-    case OBJ_STRING:
-      return stringObjectLen(key->value);
-    case OBJ_LIST:
-      return listTypeLength(key->value);
-    case OBJ_SET:
-      return setTypeSize(key->value);
-    case OBJ_ZSET:
-      return zsetLength(key->value);
-    case OBJ_HASH:
-      return hashTypeLength(key->value);
-    default:
-      return 0;
+    case OBJ_STRING: return stringObjectLen(key->value);
+    case OBJ_LIST: return listTypeLength(key->value);
+    case OBJ_SET: return setTypeSize(key->value);
+    case OBJ_ZSET: return zsetLength(key->value);
+    case OBJ_HASH: return hashTypeLength(key->value);
+    default: return 0;
@@ -909,2 +867 @@ int RM_ListPush(RedisModuleKey *key, int where, RedisModuleString *ele) {
-  listTypePush(
-      key->value, ele,
+    listTypePush(key->value, ele,
@@ -915,6 +872,5 @@ RedisModuleString *RM_ListPop(RedisModuleKey *key, int where) {
-  if (!(key->mode & REDISMODULE_WRITE) || key->value == NULL ||
-      key->value->type != OBJ_LIST)
-    return NULL;
-  robj *ele = listTypePop(key->value, (where == REDISMODULE_LIST_HEAD)
-                                          ? QUICKLIST_HEAD
-                                          : QUICKLIST_TAIL);
+    if (!(key->mode & REDISMODULE_WRITE) ||
+        key->value == NULL ||
+        key->value->type != OBJ_LIST) return NULL;
+    robj *ele = listTypePop(key->value,
+        (where == REDISMODULE_LIST_HEAD) ? QUICKLIST_HEAD : QUICKLIST_TAIL);
@@ -940,2 +896 @@ int RM_ZsetAddFlagsFromCoreFlags(int flags) {
-int RM_ZsetAdd(RedisModuleKey *key, double score, RedisModuleString *ele,
-               int *flagsptr) {
+int RM_ZsetAdd(RedisModuleKey *key, double score, RedisModuleString *ele, int *flagsptr) {
@@ -954,2 +909 @@ int RM_ZsetAdd(RedisModuleKey *key, double score, RedisModuleString *ele,
-int RM_ZsetIncrby(RedisModuleKey *key, double score, RedisModuleString *ele,
-                  int *flagsptr, double *newscore) {
+int RM_ZsetIncrby(RedisModuleKey *key, double score, RedisModuleString *ele, int *flagsptr, double *newscore) {
@@ -995 +949,2 @@ void RM_ZsetRangeStop(RedisModuleKey *key) {
-  if (key->ztype == REDISMODULE_ZSET_RANGE_LEX) zslFreeLexRange(&key->zlrs);
+    if (key->ztype == REDISMODULE_ZSET_RANGE_LEX)
+        zslFreeLexRange(&key->zlrs);
@@ -998,3 +953,4 @@ void RM_ZsetRangeStop(RedisModuleKey *key) {
-int RM_ZsetRangeEndReached(RedisModuleKey *key) { return key->zer; }
-int zsetInitScoreRange(RedisModuleKey *key, double min, double max, int minex,
-                       int maxex, int first) {
+int RM_ZsetRangeEndReached(RedisModuleKey *key) {
+    return key->zer;
+}
+int zsetInitScoreRange(RedisModuleKey *key, double min, double max, int minex, int maxex, int first) {
@@ -1011,2 +967,2 @@ int zsetInitScoreRange(RedisModuleKey *key, double min, double max, int minex,
-    key->zcurrent = first ? zzlFirstInRange(key->value->ptr, zrs)
-                          : zzlLastInRange(key->value->ptr, zrs);
+        key->zcurrent = first ? zzlFirstInRange(key->value->ptr,zrs) :
+                                zzlLastInRange(key->value->ptr,zrs);
@@ -1016,2 +972,2 @@ int zsetInitScoreRange(RedisModuleKey *key, double min, double max, int minex,
-    key->zcurrent =
-        first ? zslFirstInRange(zsl, zrs) : zslLastInRange(zsl, zrs);
+        key->zcurrent = first ? zslFirstInRange(zsl,zrs) :
+                                zslLastInRange(zsl,zrs);
@@ -1024,2 +980 @@ int zsetInitScoreRange(RedisModuleKey *key, double min, double max, int minex,
-int RM_ZsetFirstInScoreRange(RedisModuleKey *key, double min, double max,
-                             int minex, int maxex) {
+int RM_ZsetFirstInScoreRange(RedisModuleKey *key, double min, double max, int minex, int maxex) {
@@ -1028,2 +983 @@ int RM_ZsetFirstInScoreRange(RedisModuleKey *key, double min, double max,
-int RM_ZsetLastInScoreRange(RedisModuleKey *key, double min, double max,
-                            int minex, int maxex) {
+int RM_ZsetLastInScoreRange(RedisModuleKey *key, double min, double max, int minex, int maxex) {
@@ -1032,2 +986 @@ int RM_ZsetLastInScoreRange(RedisModuleKey *key, double min, double max,
-int zsetInitLexRange(RedisModuleKey *key, RedisModuleString *min,
-                     RedisModuleString *max, int first) {
+int zsetInitLexRange(RedisModuleKey *key, RedisModuleString *min, RedisModuleString *max, int first) {
@@ -1041,2 +994,2 @@ int zsetInitLexRange(RedisModuleKey *key, RedisModuleString *min,
-    key->zcurrent = first ? zzlFirstInLexRange(key->value->ptr, zlrs)
-                          : zzlLastInLexRange(key->value->ptr, zlrs);
+        key->zcurrent = first ? zzlFirstInLexRange(key->value->ptr,zlrs) :
+                                zzlLastInLexRange(key->value->ptr,zlrs);
@@ -1046,2 +999,2 @@ int zsetInitLexRange(RedisModuleKey *key, RedisModuleString *min,
-    key->zcurrent =
-        first ? zslFirstInLexRange(zsl, zlrs) : zslLastInLexRange(zsl, zlrs);
+        key->zcurrent = first ? zslFirstInLexRange(zsl,zlrs) :
+                                zslLastInLexRange(zsl,zlrs);
@@ -1054,2 +1007 @@ int zsetInitLexRange(RedisModuleKey *key, RedisModuleString *min,
-int RM_ZsetFirstInLexRange(RedisModuleKey *key, RedisModuleString *min,
-                           RedisModuleString *max) {
+int RM_ZsetFirstInLexRange(RedisModuleKey *key, RedisModuleString *min, RedisModuleString *max) {
@@ -1058,2 +1010 @@ int RM_ZsetFirstInLexRange(RedisModuleKey *key, RedisModuleString *min,
-int RM_ZsetLastInLexRange(RedisModuleKey *key, RedisModuleString *min,
-                          RedisModuleString *max) {
+int RM_ZsetLastInLexRange(RedisModuleKey *key, RedisModuleString *min, RedisModuleString *max) {
@@ -1062,2 +1013 @@ int RM_ZsetLastInLexRange(RedisModuleKey *key, RedisModuleString *min,
-RedisModuleString *RM_ZsetRangeCurrentElement(RedisModuleKey *key,
-                                              double *score) {
+RedisModuleString *RM_ZsetRangeCurrentElement(RedisModuleKey *key, double *score) {
@@ -1122 +1072,2 @@ int RM_ZsetRangeNext(RedisModuleKey *key) {
-          !zslValueLteMax(next->score, &key->zrs)) {
+                !zslValueLteMax(next->score,&key->zrs))
+            {
@@ -1175 +1126,2 @@ int RM_ZsetRangePrev(RedisModuleKey *key) {
-          !zslValueGteMin(prev->score, &key->zrs)) {
+                !zslValueGteMin(prev->score,&key->zrs))
+            {
@@ -1212 +1164,2 @@ int RM_HashSet(RedisModuleKey *key, int flags, ...) {
-          ((flags & REDISMODULE_HASH_NX) && exists)) {
+                ((flags & REDISMODULE_HASH_NX) && exists))
+            {
@@ -1223 +1176,2 @@ int RM_HashSet(RedisModuleKey *key, int flags, ...) {
-    if (flags & REDISMODULE_HASH_CFIELDS) low_flags |= HASH_SET_TAKE_FIELD;
+        if (flags & REDISMODULE_HASH_CFIELDS)
+            low_flags |= HASH_SET_TAKE_FIELD;
@@ -1277,2 +1231 @@ int RM_HashGet(RedisModuleKey *key, int flags, ...) {
-RedisModuleCallReply *moduleCreateCallReplyFromProto(RedisModuleCtx *ctx,
-                                                     sds proto) {
+RedisModuleCallReply *moduleCreateCallReplyFromProto(RedisModuleCtx *ctx, sds proto) {
@@ -1286,15 +1239,5 @@ RedisModuleCallReply *moduleCreateCallReplyFromProto(RedisModuleCtx *ctx,
-    case '+':
-      reply->type = REDISMODULE_REPLY_STRING;
-      break;
-    case '-':
-      reply->type = REDISMODULE_REPLY_ERROR;
-      break;
-    case ':':
-      reply->type = REDISMODULE_REPLY_INTEGER;
-      break;
-    case '*':
-      reply->type = REDISMODULE_REPLY_ARRAY;
-      break;
-    default:
-      reply->type = REDISMODULE_REPLY_UNKNOWN;
-      break;
+    case '+': reply->type = REDISMODULE_REPLY_STRING; break;
+    case '-': reply->type = REDISMODULE_REPLY_ERROR; break;
+    case ':': reply->type = REDISMODULE_REPLY_INTEGER; break;
+    case '*': reply->type = REDISMODULE_REPLY_ARRAY; break;
+    default: reply->type = REDISMODULE_REPLY_UNKNOWN; break;
@@ -1314,6 +1257,2 @@ void moduleParseCallReply(RedisModuleCallReply *reply) {
-    case ':':
-      moduleParseCallReply_Int(reply);
-      break;
-    case '$':
-      moduleParseCallReply_BulkString(reply);
-      break;
+    case ':': moduleParseCallReply_Int(reply); break;
+    case '$': moduleParseCallReply_BulkString(reply); break;
@@ -1321,6 +1260,2 @@ void moduleParseCallReply(RedisModuleCallReply *reply) {
-    case '+':
-      moduleParseCallReply_SimpleString(reply);
-      break;
-    case '*':
-      moduleParseCallReply_Array(reply);
-      break;
+    case '+': moduleParseCallReply_SimpleString(reply); break;
+    case '*': moduleParseCallReply_Array(reply); break;
@@ -1357,2 +1292,2 @@ void moduleParseCallReply_SimpleString(RedisModuleCallReply *reply) {
-  reply->type =
-      proto[0] == '+' ? REDISMODULE_REPLY_STRING : REDISMODULE_REPLY_ERROR;
+    reply->type = proto[0] == '+' ? REDISMODULE_REPLY_STRING :
+                                    REDISMODULE_REPLY_ERROR;
@@ -1375 +1310,2 @@ void moduleParseCallReply_Array(RedisModuleCallReply *reply) {
-    ele->flags = REDISMODULE_REPLYFLAG_NESTED | REDISMODULE_REPLYFLAG_TOPARSE;
+        ele->flags = REDISMODULE_REPLYFLAG_NESTED |
+                     REDISMODULE_REPLYFLAG_TOPARSE;
@@ -1419,2 +1355 @@ size_t RM_CallReplyLength(RedisModuleCallReply *reply) {
-RedisModuleCallReply *RM_CallReplyArrayElement(RedisModuleCallReply *reply,
-                                               size_t idx) {
+RedisModuleCallReply *RM_CallReplyArrayElement(RedisModuleCallReply *reply, size_t idx) {
@@ -1434,2 +1369 @@ const char *RM_CallReplyStringPtr(RedisModuleCallReply *reply, size_t *len) {
-      reply->type != REDISMODULE_REPLY_ERROR)
-    return NULL;
+        reply->type != REDISMODULE_REPLY_ERROR) return NULL;
@@ -1450,2 +1384 @@ RedisModuleString *RM_CreateStringFromCallReply(RedisModuleCallReply *reply) {
-    default:
-      return NULL;
+    default: return NULL;
@@ -1455,2 +1388 @@ RedisModuleString *RM_CreateStringFromCallReply(RedisModuleCallReply *reply) {
-robj **moduleCreateArgvFromUserFormat(const char *cmdname, const char *fmt,
-                                      int *argcp, int *flags, va_list ap) {
+robj **moduleCreateArgvFromUserFormat(const char *cmdname, const char *fmt, int *argcp, int *flags, va_list ap) {
@@ -1499 +1431,2 @@ fmterr:
-  for (j = 0; j < argc; j++) decrRefCount(argv[j]);
+    for (j = 0; j < argc; j++)
+        decrRefCount(argv[j]);
@@ -1503,2 +1436 @@ fmterr:
-RedisModuleCallReply *RM_Call(RedisModuleCtx *ctx, const char *cmdname,
-                              const char *fmt, ...) {
+RedisModuleCallReply *RM_Call(RedisModuleCtx *ctx, const char *cmdname, const char *fmt, ...) {
@@ -1539 +1471,2 @@ RedisModuleCallReply *RM_Call(RedisModuleCtx *ctx, const char *cmdname,
-        server.cluster->myself) {
+                           server.cluster->myself)
+        {
@@ -1648,2 +1581 @@ void moduleTypeNameByID(char *name, uint64_t moduleid) {
-moduleType *RM_CreateDataType(RedisModuleCtx *ctx, const char *name, int encver,
-                              void *typemethods_ptr) {
+moduleType *RM_CreateDataType(RedisModuleCtx *ctx, const char *name, int encver, void *typemethods_ptr) {
@@ -1697,3 +1629,3 @@ moduleType *RM_ModuleTypeGetType(RedisModuleKey *key) {
-  if (key == NULL || key->value == NULL ||
-      RM_KeyType(key) != REDISMODULE_KEYTYPE_MODULE)
-    return NULL;
+    if (key == NULL ||
+        key->value == NULL ||
+        RM_KeyType(key) != REDISMODULE_KEYTYPE_MODULE) return NULL;
@@ -1704,3 +1636,3 @@ void *RM_ModuleTypeGetValue(RedisModuleKey *key) {
-  if (key == NULL || key->value == NULL ||
-      RM_KeyType(key) != REDISMODULE_KEYTYPE_MODULE)
-    return NULL;
+    if (key == NULL ||
+        key->value == NULL ||
+        RM_KeyType(key) != REDISMODULE_KEYTYPE_MODULE) return NULL;
@@ -1719 +1651,2 @@ void moduleRDBLoadError(RedisModuleIO *io) {
-            io->type->module->name, io->type->name,
+        io->type->module->name,
+        io->type->name,
@@ -1729 +1662,2 @@ int moduleAllDatatypesHandleErrors() {
-        !(module->options & REDISMODULE_OPTIONS_HANDLE_IO_ERRORS)) {
+            !(module->options & REDISMODULE_OPTIONS_HANDLE_IO_ERRORS))
+        {
@@ -1737 +1671,3 @@ int moduleAllDatatypesHandleErrors() {
-int RM_IsIOError(RedisModuleIO *io) { return io->error; }
+int RM_IsIOError(RedisModuleIO *io) {
+    return io->error;
+}
@@ -1765,4 +1701 @@ void RM_SaveSigned(RedisModuleIO *io, int64_t value) {
-  union {
-    uint64_t u;
-    int64_t i;
-  } conv;
+    union {uint64_t u; int64_t i;} conv;
@@ -1773,4 +1706 @@ int64_t RM_LoadSigned(RedisModuleIO *io) {
-  union {
-    uint64_t u;
-    int64_t i;
-  } conv;
+    union {uint64_t u; int64_t i;} conv;
@@ -1810,2 +1740,2 @@ void *moduleLoadString(RedisModuleIO *io, int plain, size_t *lenptr) {
-  void *s = rdbGenericLoadStringObject(
-      io->rio, plain ? RDB_LOAD_PLAIN : RDB_LOAD_NONE, lenptr);
+    void *s = rdbGenericLoadStringObject(io->rio,
+              plain ? RDB_LOAD_PLAIN : RDB_LOAD_NONE, lenptr);
@@ -1887 +1817,2 @@ ssize_t rdbSaveModulesAux(rio *rdb, int when) {
-      if (!mt->aux_save || !(mt->aux_save_triggers & when)) continue;
+            if (!mt->aux_save || !(mt->aux_save_triggers & when))
+                continue;
@@ -1899,2 +1830 @@ ssize_t rdbSaveModulesAux(rio *rdb, int when) {
-void RM_DigestAddStringBuffer(RedisModuleDigest *md, unsigned char *ele,
-                              size_t len) {
+void RM_DigestAddStringBuffer(RedisModuleDigest *md, unsigned char *ele, size_t len) {
@@ -1940 +1870,2 @@ void RM_EmitAOF(RedisModuleIO *io, const char *cmdname, const char *fmt, ...) {
-  if (!io->error && rioWriteBulkCount(io->rio, '*', argc) == 0) io->error = 1;
+    if (!io->error && rioWriteBulkCount(io->rio,'*',argc) == 0)
+        io->error = 1;
@@ -1942 +1873,2 @@ void RM_EmitAOF(RedisModuleIO *io, const char *cmdname, const char *fmt, ...) {
-    if (!io->error && rioWriteBulkObject(io->rio, argv[j]) == 0) io->error = 1;
+        if (!io->error && rioWriteBulkObject(io->rio,argv[j]) == 0)
+            io->error = 1;
@@ -1960,2 +1892 @@ const RedisModuleString *RM_GetKeyNameFromIO(RedisModuleIO *io) {
-void RM_LogRaw(RedisModule *module, const char *levelstr, const char *fmt,
-               va_list ap) {
+void RM_LogRaw(RedisModule *module, const char *levelstr, const char *fmt, va_list ap) {
@@ -1965,10 +1896,5 @@ void RM_LogRaw(RedisModule *module, const char *levelstr, const char *fmt,
-  if (!strcasecmp(levelstr, "debug"))
-    level = LL_DEBUG;
-  else if (!strcasecmp(levelstr, "verbose"))
-    level = LL_VERBOSE;
-  else if (!strcasecmp(levelstr, "notice"))
-    level = LL_NOTICE;
-  else if (!strcasecmp(levelstr, "warning"))
-    level = LL_WARNING;
-  else
-    level = LL_VERBOSE;
+    if (!strcasecmp(levelstr,"debug")) level = LL_DEBUG;
+    else if (!strcasecmp(levelstr,"verbose")) level = LL_VERBOSE;
+    else if (!strcasecmp(levelstr,"notice")) level = LL_NOTICE;
+    else if (!strcasecmp(levelstr,"warning")) level = LL_WARNING;
+    else level = LL_VERBOSE;
@@ -1976,2 +1902 @@ void RM_LogRaw(RedisModule *module, const char *levelstr, const char *fmt,
-  name_len =
-      snprintf(msg, sizeof(msg), "<%s> ", module ? module->name : "module");
+    name_len = snprintf(msg, sizeof(msg),"<%s> ", module? module->name: "module");
@@ -1987,2 +1912 @@ void RM_Log(RedisModuleCtx *ctx, const char *levelstr, const char *fmt, ...) {
-void RM_LogIOError(RedisModuleIO *io, const char *levelstr, const char *fmt,
-                   ...) {
+void RM_LogIOError(RedisModuleIO *io, const char *levelstr, const char *fmt, ...) {
@@ -1997,2 +1921 @@ void RM__Assert(const char *estr, const char *file, int line) {
-void moduleBlockedClientPipeReadable(aeEventLoop *el, int fd, void *privdata,
-                                     int mask) {
+void moduleBlockedClientPipeReadable(aeEventLoop *el, int fd, void *privdata, int mask) {
@@ -2017,4 +1940 @@ void unblockClientFromModule(client *c) {
-RedisModuleBlockedClient *RM_BlockClient(
-    RedisModuleCtx *ctx, RedisModuleCmdFunc reply_callback,
-    RedisModuleCmdFunc timeout_callback,
-    void (*free_privdata)(RedisModuleCtx *, void *), long long timeout_ms) {
+RedisModuleBlockedClient *RM_BlockClient(RedisModuleCtx *ctx, RedisModuleCmdFunc reply_callback, RedisModuleCmdFunc timeout_callback, void (*free_privdata)(RedisModuleCtx*,void*), long long timeout_ms) {
@@ -2039,2 +1959,3 @@ RedisModuleBlockedClient *RM_BlockClient(
-    addReplyError(c, islua ? "Blocking module command called from Lua script"
-                           : "Blocking module command called from transaction");
+        addReplyError(c, islua ?
+            "Blocking module command called from Lua script" :
+            "Blocking module command called from transaction");
@@ -2060,2 +1981 @@ int RM_AbortBlock(RedisModuleBlockedClient *bc) {
-void RM_SetDisconnectCallback(RedisModuleBlockedClient *bc,
-                              RedisModuleDisconnectFunc callback) {
+void RM_SetDisconnectCallback(RedisModuleBlockedClient *bc, RedisModuleDisconnectFunc callback) {
@@ -2069,2 +1989 @@ void moduleHandleBlockedClients(void) {
-  while (read(server.module_blocked_pipe[0], buf, 1) == 1)
-    ;
+    while (read(server.module_blocked_pipe[0],buf,1) == 1);
@@ -2090 +2009,2 @@ void moduleHandleBlockedClients(void) {
-      if (c == NULL) ctx.flags |= REDISMODULE_CTX_BLOCKED_DISCONNECTED;
+            if (c == NULL)
+                ctx.flags |= REDISMODULE_CTX_BLOCKED_DISCONNECTED;
@@ -2102 +2022,3 @@ void moduleHandleBlockedClients(void) {
-      if (clientHasPendingReplies(c) && !(c->flags & CLIENT_PENDING_WRITE)) {
+            if (clientHasPendingReplies(c) &&
+                !(c->flags & CLIENT_PENDING_WRITE))
+            {
@@ -2166,4 +2088,7 @@ void RM_ThreadSafeContextUnlock(RedisModuleCtx *ctx) {
-void moduleAcquireGIL(void) { pthread_mutex_lock(&moduleGIL); }
-void moduleReleaseGIL(void) { pthread_mutex_unlock(&moduleGIL); }
-int RM_SubscribeToKeyspaceEvents(RedisModuleCtx *ctx, int types,
-                                 RedisModuleNotificationFunc callback) {
+void moduleAcquireGIL(void) {
+    pthread_mutex_lock(&moduleGIL);
+}
+void moduleReleaseGIL(void) {
+    pthread_mutex_unlock(&moduleGIL);
+}
+int RM_SubscribeToKeyspaceEvents(RedisModuleCtx *ctx, int types, RedisModuleNotificationFunc callback) {
@@ -2178,2 +2103 @@ int RM_SubscribeToKeyspaceEvents(RedisModuleCtx *ctx, int types,
-void moduleNotifyKeyspaceEvent(int type, const char *event, robj *key,
-                               int dbid) {
+void moduleNotifyKeyspaceEvent(int type, const char *event, robj *key, int dbid) {
@@ -2211,5 +2135 @@ void moduleUnsubscribeNotifications(RedisModule *module) {
-typedef void (*RedisModuleClusterMessageReceiver)(RedisModuleCtx *ctx,
-                                                  const char *sender_id,
-                                                  uint8_t type,
-                                                  const unsigned char *payload,
-                                                  uint32_t len);
+typedef void (*RedisModuleClusterMessageReceiver)(RedisModuleCtx *ctx, const char *sender_id, uint8_t type, const unsigned char *payload, uint32_t len);
@@ -2229,3 +2149 @@ static moduleClusterReceiver *clusterReceivers[UINT8_MAX];
-void moduleCallClusterReceivers(const char *sender_id, uint64_t module_id,
-                                uint8_t type, const unsigned char *payload,
-                                uint32_t len) {
+void moduleCallClusterReceivers(const char *sender_id, uint64_t module_id, uint8_t type, const unsigned char *payload, uint32_t len) {
@@ -2246,3 +2164 @@ void moduleCallClusterReceivers(const char *sender_id, uint64_t module_id,
-void RM_RegisterClusterMessageReceiver(
-    RedisModuleCtx *ctx, uint8_t type,
-    RedisModuleClusterMessageReceiver callback) {
+void RM_RegisterClusterMessageReceiver(RedisModuleCtx *ctx, uint8_t type, RedisModuleClusterMessageReceiver callback) {
@@ -2277,2 +2193 @@ void RM_RegisterClusterMessageReceiver(
-int RM_SendClusterMessage(RedisModuleCtx *ctx, char *target_id, uint8_t type,
-                          unsigned char *msg, uint32_t len) {
+int RM_SendClusterMessage(RedisModuleCtx *ctx, char *target_id, uint8_t type, unsigned char *msg, uint32_t len) {
@@ -2281,2 +2196 @@ int RM_SendClusterMessage(RedisModuleCtx *ctx, char *target_id, uint8_t type,
-  if (clusterSendModuleMessageToTarget(target_id, module_id, type, msg, len) ==
-      C_OK)
+    if (clusterSendModuleMessageToTarget(target_id,module_id,type,msg,len) == C_OK)
@@ -2320,4 +2234,2 @@ size_t RM_GetClusterSize(void) {
-clusterNode *clusterLookupNode(
-    const char *name);
-int RM_GetClusterNodeInfo(RedisModuleCtx *ctx, const char *id, char *ip,
-                          char *master_id, int *port, int *flags) {
+clusterNode *clusterLookupNode(const char *name);
+int RM_GetClusterNodeInfo(RedisModuleCtx *ctx, const char *id, char *ip, char *master_id, int *port, int *flags) {
@@ -2343,2 +2255 @@ int RM_GetClusterNodeInfo(RedisModuleCtx *ctx, const char *id, char *ip,
-    if (node->flags & CLUSTER_NODE_NOFAILOVER)
-      *flags |= REDISMODULE_NODE_NOFAILOVER;
+        if (node->flags & CLUSTER_NODE_NOFAILOVER) *flags |= REDISMODULE_NODE_NOFAILOVER;
@@ -2364,2 +2275 @@ typedef struct RedisModuleTimer {
-int moduleTimerHandler(struct aeEventLoop *eventLoop, long long id,
-                       void *clientData) {
+int moduleTimerHandler(struct aeEventLoop *eventLoop, long long id, void *clientData) {
@@ -2398,2 +2308 @@ int moduleTimerHandler(struct aeEventLoop *eventLoop, long long id,
-RedisModuleTimerID RM_CreateTimer(RedisModuleCtx *ctx, mstime_t period,
-                                  RedisModuleTimerProc callback, void *data) {
+RedisModuleTimerID RM_CreateTimer(RedisModuleCtx *ctx, mstime_t period, RedisModuleTimerProc callback, void *data) {
@@ -2428,2 +2337 @@ RedisModuleTimerID RM_CreateTimer(RedisModuleCtx *ctx, mstime_t period,
-    aeTimer =
-        aeCreateTimeEvent(server.el, period, moduleTimerHandler, NULL, NULL);
+        aeTimer = aeCreateTimeEvent(server.el,period,moduleTimerHandler,NULL,NULL);
@@ -2441,2 +2349 @@ int RM_StopTimer(RedisModuleCtx *ctx, RedisModuleTimerID id, void **data) {
-int RM_GetTimerInfo(RedisModuleCtx *ctx, RedisModuleTimerID id,
-                    uint64_t *remaining, void **data) {
+int RM_GetTimerInfo(RedisModuleCtx *ctx, RedisModuleTimerID id, uint64_t *remaining, void **data) {
@@ -2465 +2372,3 @@ void RM_FreeDict(RedisModuleCtx *ctx, RedisModuleDict *d) {
-uint64_t RM_DictSize(RedisModuleDict *d) { return raxSize(d->rax); }
+uint64_t RM_DictSize(RedisModuleDict *d) {
+    return raxSize(d->rax);
+}
@@ -2495,2 +2404 @@ int RM_DictDel(RedisModuleDict *d, RedisModuleString *key, void *oldval) {
-RedisModuleDictIter *RM_DictIteratorStartC(RedisModuleDict *d, const char *op,
-                                           void *key, size_t keylen) {
+RedisModuleDictIter *RM_DictIteratorStartC(RedisModuleDict *d, const char *op, void *key, size_t keylen) {
@@ -2503,2 +2411 @@ RedisModuleDictIter *RM_DictIteratorStartC(RedisModuleDict *d, const char *op,
-RedisModuleDictIter *RM_DictIteratorStart(RedisModuleDict *d, const char *op,
-                                          RedisModuleString *key) {
+RedisModuleDictIter *RM_DictIteratorStart(RedisModuleDict *d, const char *op, RedisModuleString *key) {
@@ -2511,2 +2418 @@ void RM_DictIteratorStop(RedisModuleDictIter *di) {
-int RM_DictIteratorReseekC(RedisModuleDictIter *di, const char *op, void *key,
-                           size_t keylen) {
+int RM_DictIteratorReseekC(RedisModuleDictIter *di, const char *op, void *key, size_t keylen) {
@@ -2515,2 +2421 @@ int RM_DictIteratorReseekC(RedisModuleDictIter *di, const char *op, void *key,
-int RM_DictIteratorReseek(RedisModuleDictIter *di, const char *op,
-                          RedisModuleString *key) {
+int RM_DictIteratorReseek(RedisModuleDictIter *di, const char *op, RedisModuleString *key) {
@@ -2531,2 +2436 @@ void *RM_DictPrevC(RedisModuleDictIter *di, size_t *keylen, void **dataptr) {
-RedisModuleString *RM_DictNext(RedisModuleCtx *ctx, RedisModuleDictIter *di,
-                               void **dataptr) {
+RedisModuleString *RM_DictNext(RedisModuleCtx *ctx, RedisModuleDictIter *di, void **dataptr) {
@@ -2538,2 +2442 @@ RedisModuleString *RM_DictNext(RedisModuleCtx *ctx, RedisModuleDictIter *di,
-RedisModuleString *RM_DictPrev(RedisModuleCtx *ctx, RedisModuleDictIter *di,
-                               void **dataptr) {
+RedisModuleString *RM_DictPrev(RedisModuleCtx *ctx, RedisModuleDictIter *di, void **dataptr) {
@@ -2545,2 +2448 @@ RedisModuleString *RM_DictPrev(RedisModuleCtx *ctx, RedisModuleDictIter *di,
-int RM_DictCompareC(RedisModuleDictIter *di, const char *op, void *key,
-                    size_t keylen) {
+int RM_DictCompareC(RedisModuleDictIter *di, const char *op, void *key, size_t keylen) {
@@ -2551,2 +2453 @@ int RM_DictCompareC(RedisModuleDictIter *di, const char *op, void *key,
-int RM_DictCompare(RedisModuleDictIter *di, const char *op,
-                   RedisModuleString *key) {
+int RM_DictCompare(RedisModuleDictIter *di, const char *op, RedisModuleString *key) {
@@ -2562 +2463,2 @@ int RM_InfoAddSection(RedisModuleInfoCtx *ctx, char *name) {
-  if (ctx->in_dict_field) RM_InfoEndDictField(ctx);
+    if (ctx->in_dict_field)
+        RM_InfoEndDictField(ctx);
@@ -2578,3 +2480,8 @@ int RM_InfoBeginDictField(RedisModuleInfoCtx *ctx, char *name) {
-  if (!ctx->in_section) return REDISMODULE_ERR;
-  if (ctx->in_dict_field) RM_InfoEndDictField(ctx);
-  ctx->info = sdscatprintf(ctx->info, "%s_%s:", ctx->module->name, name);
+    if (!ctx->in_section)
+        return REDISMODULE_ERR;
+    if (ctx->in_dict_field)
+        RM_InfoEndDictField(ctx);
+    ctx->info = sdscatprintf(ctx->info,
+        "%s_%s:",
+        ctx->module->name,
+        name);
@@ -2585,2 +2492,4 @@ int RM_InfoEndDictField(RedisModuleInfoCtx *ctx) {
-  if (!ctx->in_dict_field) return REDISMODULE_ERR;
-  if (ctx->info[sdslen(ctx->info) - 1] == ',') sdsIncrLen(ctx->info, -1);
+    if (!ctx->in_dict_field)
+        return REDISMODULE_ERR;
+    if (ctx->info[sdslen(ctx->info)-1]==',')
+        sdsIncrLen(ctx->info, -1);
@@ -2591,3 +2500,3 @@ int RM_InfoEndDictField(RedisModuleInfoCtx *ctx) {
-int RM_InfoAddFieldString(RedisModuleInfoCtx *ctx, char *field,
-                          RedisModuleString *value) {
-  if (!ctx->in_section) return REDISMODULE_ERR;
+int RM_InfoAddFieldString(RedisModuleInfoCtx *ctx, char *field, RedisModuleString *value) {
+    if (!ctx->in_section)
+        return REDISMODULE_ERR;
@@ -2595 +2504,4 @@ int RM_InfoAddFieldString(RedisModuleInfoCtx *ctx, char *field,
-    ctx->info = sdscatprintf(ctx->info, "%s=%s,", field, (sds)value->ptr);
+        ctx->info = sdscatprintf(ctx->info,
+            "%s=%s,",
+            field,
+            (sds)value->ptr);
@@ -2598 +2510,4 @@ int RM_InfoAddFieldString(RedisModuleInfoCtx *ctx, char *field,
-  ctx->info = sdscatprintf(ctx->info, "%s_%s:%s\r\n", ctx->module->name, field,
+    ctx->info = sdscatprintf(ctx->info,
+        "%s_%s:%s\r\n",
+        ctx->module->name,
+        field,
@@ -2603 +2518,2 @@ int RM_InfoAddFieldCString(RedisModuleInfoCtx *ctx, char *field, char *value) {
-  if (!ctx->in_section) return REDISMODULE_ERR;
+    if (!ctx->in_section)
+        return REDISMODULE_ERR;
@@ -2605 +2521,4 @@ int RM_InfoAddFieldCString(RedisModuleInfoCtx *ctx, char *field, char *value) {
-    ctx->info = sdscatprintf(ctx->info, "%s=%s,", field, value);
+        ctx->info = sdscatprintf(ctx->info,
+            "%s=%s,",
+            field,
+            value);
@@ -2608,2 +2527,5 @@ int RM_InfoAddFieldCString(RedisModuleInfoCtx *ctx, char *field, char *value) {
-  ctx->info =
-      sdscatprintf(ctx->info, "%s_%s:%s\r\n", ctx->module->name, field, value);
+    ctx->info = sdscatprintf(ctx->info,
+        "%s_%s:%s\r\n",
+        ctx->module->name,
+        field,
+        value);
@@ -2613 +2535,2 @@ int RM_InfoAddFieldDouble(RedisModuleInfoCtx *ctx, char *field, double value) {
-  if (!ctx->in_section) return REDISMODULE_ERR;
+    if (!ctx->in_section)
+        return REDISMODULE_ERR;
@@ -2615 +2538,4 @@ int RM_InfoAddFieldDouble(RedisModuleInfoCtx *ctx, char *field, double value) {
-    ctx->info = sdscatprintf(ctx->info, "%s=%.17g,", field, value);
+        ctx->info = sdscatprintf(ctx->info,
+            "%s=%.17g,",
+            field,
+            value);
@@ -2618,2 +2544,5 @@ int RM_InfoAddFieldDouble(RedisModuleInfoCtx *ctx, char *field, double value) {
-  ctx->info = sdscatprintf(ctx->info, "%s_%s:%.17g\r\n", ctx->module->name,
-                           field, value);
+    ctx->info = sdscatprintf(ctx->info,
+        "%s_%s:%.17g\r\n",
+        ctx->module->name,
+        field,
+        value);
@@ -2622,3 +2551,3 @@ int RM_InfoAddFieldDouble(RedisModuleInfoCtx *ctx, char *field, double value) {
-int RM_InfoAddFieldLongLong(RedisModuleInfoCtx *ctx, char *field,
-                            long long value) {
-  if (!ctx->in_section) return REDISMODULE_ERR;
+int RM_InfoAddFieldLongLong(RedisModuleInfoCtx *ctx, char *field, long long value) {
+    if (!ctx->in_section)
+        return REDISMODULE_ERR;
@@ -2626 +2555,4 @@ int RM_InfoAddFieldLongLong(RedisModuleInfoCtx *ctx, char *field,
-    ctx->info = sdscatprintf(ctx->info, "%s=%lld,", field, value);
+        ctx->info = sdscatprintf(ctx->info,
+            "%s=%lld,",
+            field,
+            value);
@@ -2629,2 +2561,5 @@ int RM_InfoAddFieldLongLong(RedisModuleInfoCtx *ctx, char *field,
-  ctx->info = sdscatprintf(ctx->info, "%s_%s:%lld\r\n", ctx->module->name,
-                           field, value);
+    ctx->info = sdscatprintf(ctx->info,
+        "%s_%s:%lld\r\n",
+        ctx->module->name,
+        field,
+        value);
@@ -2633,3 +2568,3 @@ int RM_InfoAddFieldLongLong(RedisModuleInfoCtx *ctx, char *field,
-int RM_InfoAddFieldULongLong(RedisModuleInfoCtx *ctx, char *field,
-                             unsigned long long value) {
-  if (!ctx->in_section) return REDISMODULE_ERR;
+int RM_InfoAddFieldULongLong(RedisModuleInfoCtx *ctx, char *field, unsigned long long value) {
+    if (!ctx->in_section)
+        return REDISMODULE_ERR;
@@ -2637 +2572,4 @@ int RM_InfoAddFieldULongLong(RedisModuleInfoCtx *ctx, char *field,
-    ctx->info = sdscatprintf(ctx->info, "%s=%llu,", field, value);
+        ctx->info = sdscatprintf(ctx->info,
+            "%s=%llu,",
+            field,
+            value);
@@ -2640,2 +2578,5 @@ int RM_InfoAddFieldULongLong(RedisModuleInfoCtx *ctx, char *field,
-  ctx->info = sdscatprintf(ctx->info, "%s_%s:%llu\r\n", ctx->module->name,
-                           field, value);
+    ctx->info = sdscatprintf(ctx->info,
+        "%s_%s:%llu\r\n",
+        ctx->module->name,
+        field,
+        value);
@@ -2648,2 +2589 @@ int RM_RegisterInfoFunc(RedisModuleCtx *ctx, RedisModuleInfoFunc cb) {
-sds modulesCollectInfo(sds info, sds section, int for_crash_report,
-                       int sections) {
+sds modulesCollectInfo(sds info, sds section, int for_crash_report, int sections) {
@@ -2654 +2594,2 @@ sds modulesCollectInfo(sds info, sds section, int for_crash_report,
-    if (!module->info_cb) continue;
+        if (!module->info_cb)
+            continue;
@@ -2657 +2598,2 @@ sds modulesCollectInfo(sds info, sds section, int for_crash_report,
-    if (info_ctx.in_dict_field) RM_InfoEndDictField(&info_ctx);
+        if (info_ctx.in_dict_field)
+            RM_InfoEndDictField(&info_ctx);
@@ -2737,2 +2679 @@ int moduleUnregisterFilters(RedisModule *module) {
-RedisModuleCommandFilter *RM_RegisterCommandFilter(
-    RedisModuleCtx *ctx, RedisModuleCommandFilterFunc callback, int flags) {
+RedisModuleCommandFilter *RM_RegisterCommandFilter(RedisModuleCtx *ctx, RedisModuleCommandFilterFunc callback, int flags) {
@@ -2747,2 +2688 @@ RedisModuleCommandFilter *RM_RegisterCommandFilter(
-int RM_UnregisterCommandFilter(RedisModuleCtx *ctx,
-                               RedisModuleCommandFilter *filter) {
+int RM_UnregisterCommandFilter(RedisModuleCtx *ctx, RedisModuleCommandFilter *filter) {
@@ -2765 +2705,4 @@ void moduleCallCommandFilters(client *c) {
-  RedisModuleCommandFilterCtx filter = {.argv = c->argv, .argc = c->argc};
+    RedisModuleCommandFilterCtx filter = {
+        .argv = c->argv,
+        .argc = c->argc
+    };
@@ -2768,2 +2711 @@ void moduleCallCommandFilters(client *c) {
-    if ((f->flags & REDISMODULE_CMDFILTER_NOSELF) && f->module->in_call)
-      continue;
+        if ((f->flags & REDISMODULE_CMDFILTER_NOSELF) && f->module->in_call) continue;
@@ -2775 +2717,2 @@ void moduleCallCommandFilters(client *c) {
-int RM_CommandFilterArgsCount(RedisModuleCommandFilterCtx *fctx) {
+int RM_CommandFilterArgsCount(RedisModuleCommandFilterCtx *fctx)
+{
@@ -2778,2 +2721,2 @@ int RM_CommandFilterArgsCount(RedisModuleCommandFilterCtx *fctx) {
-const RedisModuleString *RM_CommandFilterArgGet(
-    RedisModuleCommandFilterCtx *fctx, int pos) {
+const RedisModuleString *RM_CommandFilterArgGet(RedisModuleCommandFilterCtx *fctx, int pos)
+{
@@ -2783,2 +2726,2 @@ const RedisModuleString *RM_CommandFilterArgGet(
-int RM_CommandFilterArgInsert(RedisModuleCommandFilterCtx *fctx, int pos,
-                              RedisModuleString *arg) {
+int RM_CommandFilterArgInsert(RedisModuleCommandFilterCtx *fctx, int pos, RedisModuleString *arg)
+{
@@ -2787,2 +2730 @@ int RM_CommandFilterArgInsert(RedisModuleCommandFilterCtx *fctx, int pos,
-  fctx->argv =
-      zrealloc(fctx->argv, (fctx->argc + 1) * sizeof(RedisModuleString *));
+    fctx->argv = zrealloc(fctx->argv, (fctx->argc+1)*sizeof(RedisModuleString *));
@@ -2796,2 +2738,2 @@ int RM_CommandFilterArgInsert(RedisModuleCommandFilterCtx *fctx, int pos,
-int RM_CommandFilterArgReplace(RedisModuleCommandFilterCtx *fctx, int pos,
-                               RedisModuleString *arg) {
+int RM_CommandFilterArgReplace(RedisModuleCommandFilterCtx *fctx, int pos, RedisModuleString *arg)
+{
@@ -2803 +2745,2 @@ int RM_CommandFilterArgReplace(RedisModuleCommandFilterCtx *fctx, int pos,
-int RM_CommandFilterArgDelete(RedisModuleCommandFilterCtx *fctx, int pos) {
+int RM_CommandFilterArgDelete(RedisModuleCommandFilterCtx *fctx, int pos)
+{
@@ -2838,2 +2781,2 @@ int TerminateModuleForkChild(int child_pid, int wait) {
-  if (server.module_child_pid == -1 || server.module_child_pid != child_pid)
-    return C_ERR;
+    if (server.module_child_pid == -1 ||
+        server.module_child_pid != child_pid) return C_ERR;
@@ -2845,2 +2788 @@ int TerminateModuleForkChild(int child_pid, int wait) {
-           server.module_child_pid)
-      ;
+              server.module_child_pid);
@@ -2862 +2804,2 @@ void ModuleForkDoneHandler(int exitcode, int bysignal) {
-  serverLog(LL_NOTICE, "Module fork exited pid: %d, retcode: %d, bysignal: %d",
+    serverLog(LL_NOTICE,
+        "Module fork exited pid: %d, retcode: %d, bysignal: %d",
@@ -2889,0 +2833,2 @@ int moduleRegisterApi(const char *funcname, void *funcptr) {
+#define REGISTER_API(name) \
+    moduleRegisterApi("RedisModule_" #name, (void *)(unsigned long)RM_ ## name)
@@ -2918,3 +2863,5 @@ void moduleLoadFromQueue(void) {
-    if (moduleLoad(loadmod->path, (void **)loadmod->argv, loadmod->argc) ==
-        C_ERR) {
-      serverLog(LL_WARNING, "Can't load module from %s: server aborting",
+        if (moduleLoad(loadmod->path,(void **)loadmod->argv,loadmod->argc)
+            == C_ERR)
+        {
+            serverLog(LL_WARNING,
+                "Can't load module from %s: server aborting",
@@ -2940 +2887,2 @@ void moduleUnregisterCommands(struct RedisModule *module) {
-      RedisModuleCommandProxy *cp = (void *)(unsigned long)cmd->getkeys_proc;
+            RedisModuleCommandProxy *cp =
+                (void*)(unsigned long)cmd->getkeys_proc;
@@ -2962,2 +2910 @@ int moduleLoad(const char *path, void **module_argv, int module_argc) {
-  onload = (int (*)(void *, void **, int))(unsigned long)dlsym(
-      handle, "RedisModule_OnLoad");
+    onload = (int (*)(void *, void **, int))(unsigned long) dlsym(handle,"RedisModule_OnLoad");
@@ -2968,2 +2915 @@ int moduleLoad(const char *path, void **module_argv, int module_argc) {
-              "symbol. Module not loaded.",
-              path);
+            "symbol. Module not loaded.",path);
@@ -2980,2 +2926,2 @@ int moduleLoad(const char *path, void **module_argv, int module_argc) {
-    serverLog(LL_WARNING, "Module %s initialization failed. Module not loaded",
-              path);
+        serverLog(LL_WARNING,
+            "Module %s initialization failed. Module not loaded",path);
@@ -3064,2 +3010 @@ sds genModulesInfoString(sds info) {
-    info =
-        sdscatprintf(info,
+        info = sdscatprintf(info,
@@ -3083 +3028,3 @@ void moduleCommand(client *c) {
-        "UNLOAD <name> -- Unload a module.", NULL};
+"UNLOAD <name> -- Unload a module.",
+NULL
+        };
@@ -3085 +3032,2 @@ void moduleCommand(client *c) {
-  } else if (!strcasecmp(subcmd, "load") && c->argc >= 3) {
+    } else
+    if (!strcasecmp(subcmd,"load") && c->argc >= 3) {
@@ -3095,2 +3043,2 @@ void moduleCommand(client *c) {
-      addReplyError(
-          c, "Error loading the extension. Please check the server logs.");
+            addReplyError(c,
+                "Error loading the extension. Please check the server logs.");
@@ -3107,2 +3055 @@ void moduleCommand(client *c) {
-          errmsg =
-              "the module exports one or more module-side data "
+                errmsg = "the module exports one or more module-side data "
@@ -3112,2 +3059 @@ void moduleCommand(client *c) {
-          errmsg =
-              "the module exports APIs used by other modules. "
+                errmsg = "the module exports APIs used by other modules. "
@@ -3129 +3075,3 @@ void moduleCommand(client *c) {
-size_t moduleCount(void) { return dictSize(modules); }
+size_t moduleCount(void) {
+    return dictSize(modules);
+}
@@ -3297 +3245,3 @@ void moduleRegisterCoreAPI(void) {
-<<<<<<< HEAD
+    REGISTER_API(Fork);
+    REGISTER_API(ExitFromChild);
+    REGISTER_API(KillForkChild);
@@ -3307,6 +3256,0 @@ void moduleRegisterCoreAPI(void) {
-|||||||
-=======
-  REGISTER_API(Fork);
-  REGISTER_API(ExitFromChild);
-  REGISTER_API(KillForkChild);
->>>>>>> a9628142fd3ce5e3d221ba4b60bcb33c394140e1
